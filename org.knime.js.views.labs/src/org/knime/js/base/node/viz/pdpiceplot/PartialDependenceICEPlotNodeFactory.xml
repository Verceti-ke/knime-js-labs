<?xml version="1.0" encoding="utf-8"?>
<knimeNode icon="./partial_dependence_plot.png" type="Visualizer"
	xmlns="http://knime.org/node/v3.1"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://knime.org/node/v3.1 http://knime.org/node/v3.1.xsd">

	<name>Partial Dependence/ICE Plot (JavaScript)</name>
	<shortDescription>A node which creates an interactive Partial Dependence (PDP) 
	/ Individual Conditional Expectation (ICE) plot view using JavaScript.
	</shortDescription>
	<fullDescription>
		<intro>
			<p>
				This node is able to visualize how the prediction at the output of a model reacts as a single column is changed in a defined range.
				Such visualization can help you interpret how any model is using a single column locally, that is visualizing the prediction change instance by instance, and globally, visualizing an overall behavior valid for the majority of the instances but not the outliers.
			</p>
			<p>
				The Individual Conditional Expectation (ICE) visualizes the prediction change locally to a single instance in a simple line plot. You can visualize many ICE plots by having multiple lines in the same charts. Use the markers in the shape of dots to keep track the original column value and the original prediction each instance has. To visualize colors for different groups/category/clusters add a Color Manager node before this node.		
			</p>
			<p>
				The Partial Dependence Plot (PDP) visualizes the global average prediction change over a number of instances in a line plot.
				By default you can also visualize how widely the single instances predictions variegates from the average by means of a colored area around the line plot.
			</p>
			<p>
				The generated view is highly interactive and custom to your needs.
				Change the opacity and sizes of the visual elements to your needs from the node dialogue.
				From the view itself you can toggle between displaying both ICEs and PDP or just one of them.
			</p>
			<p>
				ICE is useful to assess the exact prediction change an a single instance or on a small group of instances. When visualizing a global behavior of the model for many instances PDP can be useful, even if it could simplify too much the complexity behind such predictions.
			</p>
			<p>
				The best way to use this node is in a <a href="https://www.knime.com/knime-introductory-course/chapter5/section3/composite-views">Composite View</a> by interactively filtering and selecting groups of similar instances.
			</p>
			<p>
				The node supports custom CSS styling. You can simply put CSS rules
				into a single string and set it as a flow variable 'customCSS' in
				the node configuration dialog. You will find the list of available
				classes and their description on our
				<a href="https://knime.com/css-styling">documentation page</a>.
			</p>
		</intro>
		<tab name="Options">
		    <description>
                General node options.
            </description>
			<option name="Create image at outport">
				Select this option to create an SVG image of the chart at outport 1.
			</option>
			<option name="Maximum number of rows">
				Use this option to filter out the input data to a fixed number of 
				rows from the original data table (inport 2). This number 
				corresponds to the maximum number of ICE lines to be displayed.
			</option>
			<option name="Choose the feature column (model table)">
				Select the column of sampled feature values from the model output at
				inport 1.
			</option>
			<option name="Choose the row ID column (model table)">
				Select the column of Row ID's corresponding to the original Row ID's
				from the training data. This column is chosen from the model output 
				table at inport 1.
			</option>
			<option name="Choose the prediction column (model table)">
				Select the column of model predictions from the model output table at
				inport 1.
			</option>
			<option name="Choose the feature columnd (original table)">
				Select the column corresponding to the feature that was sampled and
				processed by the model from the columns of the original data table at
				inport 2.
			</option>
		</tab>
		<tab name="PDP/ICE">
		    <description>
                Partial Dependence and Individual Conditional Expectation Line Options.
            </description>
			<option name="Show partial dependence plot">
				Select this option to display the Partial Dependence Plot of the data
				on the chart. Selecting this option will enable additional options in
				the dialog relating to the PDP.
			</option>
			<option name="Partial dependence plot color">
				Using the color chooser, select the color in which to display the PDP
				line. This color will also apply to the PDP margin area, but the opacity
				of this area can be configured separately.
			</option>
			<option name="PDP line weight">
				The weight (CSS style "stroke-width") of the PDP line.
			</option>
			<option name="Show partial dependence margin">
				Select this option to display a shaded border of the Partial Dependence Plot
				 of the data on the chart. Selecting this option will enable additional options in
				the dialog relating to the PDP margin.
			</option>
			<option name="PDP margin value">
				Select the method with which to calculate the distance of the PDP margin from
				the PDP line. This measure is the instantaneous calculation at a given
				feature value along the x-axis and is displayed both above and below the
				PDP line. Both methods use Bessel's Sample Correction (n-1).
			</option>
			<option name="PDP margin multiplier">
				This value determines the scale of the PDP margin with the selected calculation.
				For example, selecting "Standard Deviation" in the previous option and ".5" in this
				option will result in a PDP Margin painted .5 x (the instantaneous standard deviation)
				above <i>and</i> below the PDP line across the feature domain.
			</option>
			<option name="PDP margin opacity">
				Select the opacity of the shaded PDP margin on a scale of 0-1 (0: transparent, 1:
				 opaque).
			</option>
			<option name="Show individual conditional expectation lines">
				Select this option to display a single line for each row of data from the original
				data table (inport 2) with its values corresponding to the model's output prediction
				across the feature space.
			</option>
			<option name="Individual conditional expectation color">
				Using the color chooser, select the color in which to display the ICE lines.
			</option>
			<option name="ICE line weight">
				The weight (CSS style "stroke-width") of the ICE lines.
			</option>
			<option name="ICE line opacity">
				Select the opacity of the ICE lines on a scale of 0-1 (0: transparent, 1:
				 opaque).
			</option>
			<option name="Show original data points">
				Select this option to display a single point for each row of data from the original
				data table (inport 2) with its x-value corresponding to the original data point and 
				it's y-value calculated to fall close to it's model output prediction. Useful to see
				the reliability of areas of the model output which are strongly supported by real data
				values.
			</option>
			<option name="Data point color">
				Using the color chooser, select the color in which to display the data points.
			</option>
			<option name="Data point weight">
				The weight (css style "r") of the data point SVG elements.
			</option>
			<option name="Data point opacity">
				Select the opacity of the ICE lines on a scale of 0-1 (0: transparent, 1:
				 opaque).
			</option>
		</tab>
		<tab name="Plot Options">
			<option name="Chart Title" optional="true">
				The subtitle of the
				graph shown above the generated image. If left blank, no subtitle
				will be shown.
			</option>
			<option name="Chart subtitle" optional="true">
				The subtitle of the
				graph shown above the generated image. If left blank, no subtitle
				will be shown.
			</option>
			<option name="X-Axis Label" optional="true">
				The label displayed horizontally under the X-Axis. If left blank, no
				label will be shown.
			</option>
			<option name="Y-Axis Label" optional="true">
				The label displayed horizontally under the Y-Axis. If left blank, no
				label will be shown.
			</option>
			<option name="Y-Axis % margin">
				This can be used to set the vertical bounds of the chart by scaling the
				Y-Axis by a certain percent. The calculation is done using the domain of
				the Y-Axis as calculated by this node or the existing Data Table 
				Specifications. ex: setting this to 10 with a y-min of 0 and a y-max of 1,
				the resulting chart will display a range along the y-axis from -0.1-1.1.
			</option>
			<option name="Resize to fill screen">
				If this setting is selected the resulting chart will be displayed in the full 
				width of its native browser component. Selecting this setting disables the
				width and height options.
			</option>
			<option name="Width">
				If "Resize to fill screen" has not been selected, the image will be rendered at
				the user specified dimensions. Use this setting to choose the width of the chart 
				in pixels.
			</option>
			<option name="Height">
				If "Resize to fill screen" has not been selected, the image will be rendered at
				the user specified dimensions. Use this setting to choose the height of the chart 
				in pixels.
			</option>
			<option name="Background color">
				Using the color chooser, select the color in which to display the overall window 
				background.
			</option>
			<option name="Data area color">
				Using the color chooser, select the color in which to display the area within the 
				grid lines explicitly used for displaying the data.
			</option>
			<option name="Show grid">
				Selecting this option chooses to enable the grid lines in the data plane. If selected
				enables the grid color chooser as the next option.
			</option>
			<option name="Grid color">
				Using the color chooser, select the color for the displayed grid lines, if enabled.
			</option>
			<option name="Show warnings in interactive view">
				Selecting this option will collect warnings accumulated during execution and
				display them in the interactive view.
			</option>
		</tab>
		<tab name="Interactivity">
			<option name="Enable controls in view">
				If checked interactive controls will be enabled in the view. If this option
				is not selected, no controls will be displayed and the options below will be disabled.
			</option>
			<option name="Enable smart zoom controls">
				Enables vertical scale locking controls.
			</option>
			<option name="Enable fullscreen button">
				Enables the full-screen option when view in conjunction with other views in a
				wrapped meta-node setting.
			</option>
			<option name="Enable title controls">
				Enables editing the title and subtitle while the interactive view is open if enabled.
				The title and subtitle must first be set in the Node Dialog fields and then modified 
				in the view, or else these options will not be available.
			</option>
			<option name="Enable axis label controls">
				Enables in-view editing and modification of the axis labels.
			</option>
			<option name="Enable PDP controls">
				Enables controls for the PDP line toggling and weight.
			</option>
			<option name="Enable PDP margin controls">
				Enables controls for the PDP margin, calculation, multiplier and opacity.
			</option>
			<option name="Enable ICE controls">
				Enables controls for toggling ICE lines, their weight and opacity.
			</option>
			<option name="Enable data point controls">
				Enables controls for toggling the display of data points, their weight,
				and opacity.
			</option>
			<option name="Enable static line controls">
				Enables controls for displaying a static line on the chart, controlling its
				weight and it's y-value.
			</option>
			<option name="Enable Y-Axis margin controls">
				Enables the option to vertically scale the chart while in the interactive view.
			</option>
			<option name="Enable selection controls">
				Enables "Clear Selection" button, "Mouse Mode Select" button. Only available
				if selection is enabled in the "Interactive Events" section lower down on this
				dialog window.
			</option>
			<option name="Enable selection/filter event controls">
				Enable the ability to turn on and off Subscriptions to filters and selection
				in the view as well as toggle publishing selection events.
			</option>
			<option name="Enable grid controls">
				Enables controls to toggle on and off the grid from the interactive view.
			</option>
			<option name="Enable advanced options">
				Enables an option in the interactive KNIME menu to display visualization options
				for the partial dependence line, margin, individual conditional expectation lines,
				and data points (if their respective controls are enabled).
			</option>
			<option name="Enable panning in view">
				Enables horizontal zooming in the view.
			</option>
			<option name="Show zoom reset button">
				Enables a button to reset the scale of the chart when zoom has been altered.
			</option>
			<option name="Enable scroll zoom">
				Enables the use of scrolling to zoom in and out on the chart.
			</option>
			<option name="Enable smart-zoom">
				Enables the locking of the vertical scale to transform and pan through the chart
				horizontally.
			</option>
			<option name="Enable selection in view">
				Allows the selection of individual rows in the interactive chart. Applying these
				changes will append a selected row to the original data table (inport 2) and output
				the new table at outport 2. Enabling selection will also enable the option to have 
				selection controls available in view. 
			</option>
			<option name="Subscribe to filter events">
				Selecting this option will listen for other nodes in the same meta-node environment 
				publishing filter events and will render the changes automatically.
			</option>
			<option name="Subscribe to selection events">
				Selecting this option will listen for other nodes in the same meta-node environment 
				publishing selection events and will render the changes automatically.
			</option>
			<option name="Publish to selection events">
				Selecting this option will publish to other nodes in the same meta-node environment 
				changes in the selection state of this node and will render the changes automatically.
			</option>
			<option name="Display static line">
				Selecting this option displays a static horizontal "Threshold" line on the chart and
				enables additional options regarding that line.
			</option>
			<option name="Static color">
				Using the color chooser, select the color in which to display the static threshold line.
			</option>
			<option name="Static line weight">
				The weight (CSS style "stroke-width") of the static threshold line.
			</option>
			<option name="Static line y-value">
				This option chooses the y-value of the static threshold line on the chart.
			</option>
		</tab>
	</fullDescription>
	<interactiveView name="Partial Dependence/ICE Plot">
		An interactive Partial Dependence (PDP)/Individual Conditional Expectation (ICE)
		plot representation of the model output.
	</interactiveView>
	<ports>
		<inPort name="Model output table" index="0">
			Prediction model output table or Partial Dependence/ICE Plot pre-
			processing node output table.
		</inPort>
		<inPort name="Original data table" index="1">
			Original data table which was fed into the prediction model.
		</inPort>
		<outPort name="Image port" index="0">
			An SVG image representation
			of the view if "Generate Image" option was enabled.
		</outPort>
		<outPort name="Output table" index="1">
			The input data table, with
			an appended selection column if selection is enabled.
		</outPort>
	</ports>
</knimeNode>